# ğŸš€ Gen2: EfficientNet-V2-L @ 512 with Test Pseudo-labels
# ç›®æ¨™ï¼šçªç ´ 90% - ä½¿ç”¨æ¸¬è©¦é›†é«˜ç½®ä¿¡åº¦å½æ¨™ç±¤é€²è¡Œè‡ªç›£ç£å­¸ç¿’
# é æœŸé©—è­‰ F1: 88.5-89.5%

data:
  train_csv: data/fold{fold}_train_gen2.csv  # Gen2 è¨“ç·´é›† (å«æ¸¬è©¦é›†å½æ¨™ç±¤)
  val_csv: data/fold{fold}_val.csv
  file_col: new_filename
  label_cols: [normal, bacteria, virus, COVID-19]
  images_dir_train: train_images_gen2_gen2  # åŸå§‹è¨“ç·´å½±åƒï¼ˆå°‡åœ¨è¨“ç·´è…³æœ¬ä¸­è™•ç†æ··åˆç›®éŒ„ï¼‰
  images_dir_val: train_images
  images_dir_test: test_images
  test_csv: data/test_data.csv
  num_classes: 4
  submission_cols: [normal, bacteria, virus, COVID-19]
  submission_file_col: new_filename

model:
  name: efficientnet_v2_l
  img_size: 512
  dropout: 0.35  # â†‘ å¢åŠ  dropout (from 0.30) é˜²æ­¢éæ“¬åˆåˆ°å½æ¨™ç±¤
  drop_path_rate: 0.25  # â†‘ å¢åŠ  stochastic depth

train:
  epochs: 50  # â†‘ å¢åŠ  epochs (from 40) åˆ©ç”¨æ›´å¤šæ•¸æ“š
  batch_size: 4
  lr: 0.00008  # â†“ é™ä½å­¸ç¿’ç‡ (from 0.0001) æ›´ç©©å®šè¨“ç·´
  optimizer: adamw
  weight_decay: 0.0003  # â†‘ æ›´å¼·æ­£å‰‡åŒ– (from 0.0002)
  patience: 18  # â†‘ æ›´å¤§è€å¿ƒ (from 15)
  seed: 42
  num_workers: 4
  use_amp: true
  use_compile: false
  channels_last: true
  gradient_clip: 1.0

# æ•¸æ“šå¢å¼· - æ›´æ¿€é€²ï¼ˆå› ç‚ºæœ‰æ›´å¤šæ•¸æ“šï¼‰
augmentation:
  mixup_prob: 0.8  # â†‘ æ›´æ¿€é€² Mixup (from 0.7)
  mixup_alpha: 2.0  # â†‘ æ›´å¼·æ··åˆ (from 1.5)
  cutmix_prob: 0.6  # â†‘ from 0.5
  aug_rotation: 25  # â†‘ æ›´å¤§æ—‹è½‰ (from 20)
  aug_scale: [0.80, 1.20]  # â†‘ æ›´å¯¬ç¯„åœ
  random_erasing_prob: 0.45  # â†‘ from 0.4
  h_flip_prob: 0.5
  v_flip_prob: 0.0

# Loss - å¾®èª¿
loss:
  type: improved_focal
  focal_alpha: [1.0, 1.5, 2.5, 15.0]  # â†‘ Virus å’Œ COVID-19 æ¬Šé‡å¾®èª¿
  focal_gamma: 4.0  # â†‘ æ›´å°ˆæ³¨å›°é›£æ¨£æœ¬ (from 3.5)
  label_smoothing: 0.18  # â†‘ æ›´å¼· smoothing (from 0.15)

# å­¸ç¿’ç‡èª¿åº¦
scheduler:
  type: cosine
  warmup_epochs: 4  # â†‘ æ›´é•· warmup (from 3)
  min_lr: 0.0000005  # â†“ æ›´ä½æœ€å°å­¸ç¿’ç‡

# SWA
swa:
  use_swa: true
  swa_start_epoch: 38  # â†‘ æ›´æ™šå•Ÿå‹• (from 30)
  swa_lr: 0.00004  # â†“ æ›´ä½ SWA å­¸ç¿’ç‡

# è¼¸å‡º
out:
  dir: outputs/v2l_512_gen2/fold{fold}
  submission_path: data/submission_v2l_512_gen2_fold{fold}.csv

# Gen2 ç‰¹æ®Šé…ç½®
gen2:
  use_test_pseudo: true  # æ¨™è¨˜ä½¿ç”¨äº†æ¸¬è©¦é›†å½æ¨™ç±¤
  pseudo_count: 532      # å½æ¨™ç±¤æ•¸é‡
  pseudo_conf_threshold: 0.9861  # å¹³å‡ç½®ä¿¡åº¦
  description: "Self-supervised learning with ultra-high-confidence test pseudo-labels"
