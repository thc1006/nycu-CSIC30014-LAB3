# ğŸš€ æ¦¨ä¹¾ GPU é…ç½® - RTX 4070 Ti SUPER æœ€å¤§åŒ–
# ç›®æ¨™: æœ€å¤§åŒ– GPU åˆ©ç”¨ç‡å’Œ VRAM ä½¿ç”¨

inherits: configs/base_colab.yaml

data:
  images_dir_train: train_images
  images_dir_val: val_images
  train_csv: data/fold0_train.csv
  val_csv: data/fold0_val.csv
  test_csv: data/test_data.csv
  file_col: new_filename
  label_cols: [normal, bacteria, virus, COVID-19]
  num_classes: 4

  # ğŸ¥ é†«å­¸å½±åƒé è™•ç†
  medical_preprocessing: true
  preprocessing_preset: default

train:
  seed: 42

  # ğŸ”¥ æ¦¨ä¹¾ GPU - æ›´é•·è¨“ç·´
  epochs: 35  # å¢åŠ åˆ° 35
  batch_size: 48  # ğŸš€ å¾ 24 ç¿»å€åˆ° 48 (æ¦¨ä¹¾ 16GB VRAM)

  # å„ªåŒ–å™¨é…ç½®
  num_workers: 12  # å¢åŠ  CPU ç·šç¨‹æ•¸
  lr: 0.0001  # ç•¥å¾®æé«˜å­¸ç¿’ç‡é…åˆæ›´å¤§ batch
  weight_decay: 0.0005
  optimizer: adamw

  # å­¸ç¿’ç‡èª¿åº¦
  scheduler: cosine
  warmup_epochs: 3

  # è™•ç†æ¥µåº¦ä¸å¹³è¡¡
  use_weighted_sampler: true

  # ğŸ¯ å„ªåŒ– Focal Loss
  loss: improved_focal
  focal_alpha: [1.0, 2.0, 2.0, 20.0]
  focal_gamma: 3.0
  label_smoothing: 0.05

  # ğŸ”¥ æ¿€é€²çš„è³‡æ–™å¢å¼·
  augment: true
  advanced_aug: true
  mixup_prob: 0.4
  mixup_alpha: 1.0
  cutmix_prob: 0.4
  cutmix_alpha: 1.0

  # é«˜ç´šå¢å¼·åƒæ•¸
  aug_rotation: 12
  aug_translate: 0.08
  aug_scale_min: 0.92
  aug_scale_max: 1.08
  aug_shear: 8
  random_erasing_prob: 0.25

  # ğŸŒŸ SWA
  use_swa: true
  swa_start_epoch: 27
  swa_lr: 0.00005

perf:
  # ğŸš€ æ¦¨ä¹¾ GPU
  amp_dtype: fp16
  channels_last: true
  cudnn_benchmark: true
  tf32: high

model:
  # ğŸ¯ æ›´å¤§çš„æ¨¡å‹ä»¥åˆ©ç”¨æ›´å¤š GPU
  name: efficientnet_v2_s  # æ¢å¾©ä½¿ç”¨ V2-S (æ¯” B0 å¤§)
  img_size: 384  # æ¢å¾© 384px (æ›´é«˜è§£æåº¦)
  pretrained: true

out:
  dir: outputs/kfold_max_gpu/fold0
  checkpoint_path: outputs/kfold_max_gpu/fold0/best.pt
  submission_path: data/submission_max_gpu_fold0.csv
