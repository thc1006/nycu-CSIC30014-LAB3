# ğŸš€ æœ€çµ‚å„ªåŒ–é…ç½® - æ¦¨ä¹¾ GPU (ä¸ç”¨ Caching)
# ç­–ç•¥: å¤§ Batch + é†«å­¸é è™•ç† + K-Fold CV

inherits: configs/base_colab.yaml

data:
  images_dir_train: train_images
  images_dir_val: val_images
  train_csv: data/fold4_train.csv
  val_csv: data/fold4_val.csv
  test_csv: data/test_data.csv
  file_col: new_filename
  label_cols: [normal, bacteria, virus, COVID-19]
  num_classes: 4

  # ğŸ¥ é†«å­¸å½±åƒé è™•ç† (CLAHE + Unsharp)
  medical_preprocessing: true
  preprocessing_preset: default

train:
  seed: 42

  epochs: 35
  batch_size: 56  # ğŸ”¥ æ¦¨ä¹¾ GPU - æœ€å¤§ batch size

  num_workers: 10
  lr: 0.00011
  weight_decay: 0.0005
  optimizer: adamw

  scheduler: cosine
  warmup_epochs: 3

  use_weighted_sampler: true

  # Focal Loss
  loss: improved_focal
  focal_alpha: [1.0, 2.0, 2.0, 20.0]
  focal_gamma: 3.0
  label_smoothing: 0.05

  # è³‡æ–™å¢å¼·
  augment: true
  advanced_aug: true
  mixup_prob: 0.4
  mixup_alpha: 1.0
  cutmix_prob: 0.4
  cutmix_alpha: 1.0

  aug_rotation: 12
  aug_translate: 0.08
  aug_scale_min: 0.92
  aug_scale_max: 1.08
  aug_shear: 8
  random_erasing_prob: 0.25

  # SWA
  use_swa: true
  swa_start_epoch: 27
  swa_lr: 0.00005

perf:
  amp_dtype: fp16
  channels_last: true
  cudnn_benchmark: true
  tf32: high

model:
  name: efficientnet_v2_s  # ğŸ”¥ ä½¿ç”¨ V2-S (æ›´å¼·)
  img_size: 352  # 352px å¹³è¡¡
  pretrained: true

out:
  dir: outputs/final_optimized/fold4
  checkpoint_path: outputs/final_optimized/fold4/best.pt
  submission_path: data/submission_final_fold4.csv
