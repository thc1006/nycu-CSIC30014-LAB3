# æ”¹é€²çš„ Breakthrough é…ç½®
# åŸºæ–¼ 0.81977 çš„æˆåŠŸé…ç½®ï¼Œé€²ä¸€æ­¥å„ªåŒ–
# ç›®æ¨™: çªç ´ 82%+

inherits: configs/base_colab.yaml

data:
  # ä½¿ç”¨åŸå§‹è³‡æ–™åˆ†å‰² (èˆ‡æ¸¬è©¦é›†åˆ†å¸ƒä¸€è‡´)
  images_dir_train: train_images
  images_dir_val: val_images
  images_dir_test: test_images
  train_csv: data/train_data.csv
  val_csv: data/val_data.csv
  test_csv: data/test_data.csv
  file_col: new_filename
  label_cols: [normal, bacteria, virus, COVID-19]
  num_classes: 4

  # âŒ ä¸ä½¿ç”¨é†«å­¸é è™•ç† (æœƒç ´å£ ImageNet features)
  medical_preprocessing: false

train:
  seed: 42

  # å„ªåŒ–è¨“ç·´æ™‚é•·
  epochs: 45  # å¢åŠ  5 epochs
  batch_size: 24  # ç¨å¾®å¢åŠ  batch (from 20)

  # å„ªåŒ–å™¨é…ç½®
  num_workers: 10
  lr: 0.00008  # ç•¥é™å­¸ç¿’ç‡ (from 0.0001)
  weight_decay: 0.00015  # å¢åŠ æ­£å‰‡åŒ– (from 0.0001)
  optimizer: adamw

  # å­¸ç¿’ç‡èª¿åº¦
  scheduler: cosine
  warmup_epochs: 6  # æ›´é•· warmup (from 5)

  # è™•ç†æ¥µåº¦ä¸å¹³è¡¡
  use_weighted_sampler: true

  # ğŸ¯ æ ¸å¿ƒï¼šå„ªåŒ– Focal Loss æ¬Šé‡
  loss: improved_focal
  focal_alpha: [1.0, 1.5, 2.0, 12.0]  # COVID-19 é™è‡³ 12 (from 15)
  focal_gamma: 3.5  # å¢åŠ  gamma å°ˆæ³¨å›°é›£æ¨£æœ¬ (from 3.0)
  label_smoothing: 0.12  # ç•¥å¢ smoothing (from 0.1)

  # ğŸ”¥ å¢å¼·çš„è³‡æ–™å¢å¼·
  augment: true
  advanced_aug: true
  mixup_prob: 0.6  # å¢åŠ  mixup (from 0.5)
  mixup_alpha: 1.2  # æ›´å¼· mixup (from 1.0)
  cutmix_prob: 0.5
  cutmix_alpha: 1.0

  # é«˜ç´šå¢å¼·åƒæ•¸
  aug_rotation: 18  # ç•¥å¢æ—‹è½‰ (from 15)
  aug_translate: 0.12  # ç•¥å¢å¹³ç§» (from 0.1)
  aug_scale_min: 0.88  # æ›´å¤§ç¯„åœ (from 0.9)
  aug_scale_max: 1.12  # æ›´å¤§ç¯„åœ (from 1.1)
  aug_shear: 12  # å¢åŠ å‰ªåˆ‡ (from 10)
  random_erasing_prob: 0.35  # å¢åŠ æ“¦é™¤ (from 0.3)

  # ğŸŒŸ Stochastic Weight Averaging
  use_swa: true
  swa_start_epoch: 35  # å»¶å¾Œå•Ÿå‹• (from 30)
  swa_lr: 0.00004  # é™ä½ SWA lr (from 0.00005)

  # æ—©åœ
  early_stopping: true
  patience: 12  # å¢åŠ  patience (from 10)
  min_delta: 0.0001

perf:
  # æ··åˆç²¾åº¦è¨“ç·´
  amp_dtype: fp16
  channels_last: true
  cudnn_benchmark: true
  tf32: high

model:
  # é—œéµï¼šä¿æŒ 384px é«˜è§£æåº¦
  name: efficientnet_v2_s
  img_size: 384  # âœ… ä¿æŒ 384 (ä¸é™è‡³ 352)
  pretrained: true
  dropout: 0.25  # å¢åŠ  dropout é˜²æ­¢éæ“¬åˆ

out:
  dir: outputs/improved_breakthrough
  checkpoint_path: outputs/improved_breakthrough/best.pt
  submission_path: data/submission_improved.csv
