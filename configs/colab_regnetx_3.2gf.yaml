# RegNetX-3.2GF config - Optimized for medical imaging
# Target: 86-88% (15.3M params, low overfitting)

data:
  # Relative paths (works on both Colab and local)
  images_dir_train: train_images
  images_dir_val: val_images
  images_dir_test: test_images

  # CSV paths
  train_csv: data/train_data.csv
  val_csv: data/val_data.csv
  test_csv: data/test_data.csv

  file_col: new_filename
  label_cols: [normal, bacteria, virus, COVID-19]
  submission_cols: [normal, bacteria, virus, COVID-19]
  submission_file_col: new_filename
  num_classes: 4

train:
  seed: 44                      # Different seed for diversity
  epochs: 16                    # Standard training
  batch_size: 28                # Smaller model, larger batch
  num_workers: 0                # MUST be 0 for GPU cached (data on GPU)
  lr: 0.0003                    # Standard LR
  weight_decay: 0.0001
  optimizer: adamw
  scheduler: cosine
  warmup_epochs: 1

  # Early stopping
  patience: 8
  min_delta: 0.0005

  # Advanced training strategy
  use_weighted_sampler: true    # CRITICAL for COVID-19 (1% samples)
  loss: ce                      # CrossEntropy
  label_smoothing: 0.1          # Higher smoothing

  # GPU optimizations
  use_gpu_cache: true
  use_compile: true
  compile_mode: default

  # Aggressive augmentation (medical imaging research 2024)
  use_mixup: true
  mixup_alpha: 0.2
  mixup_prob: 0.5
  advanced_aug: true
  aug_rotation: 20
  aug_translate: 0.15
  aug_scale_min: 0.75
  aug_scale_max: 1.25
  aug_shear: 15
  random_erasing_prob: 0.3

perf:
  amp_dtype: bf16               # bfloat16 AMP (A100 optimized)
  channels_last: true
  cudnn_benchmark: true
  tf32: medium

model:
  name: regnet_x_3_2gf          # RegNetX-3.2GF (15.3M params)
  img_size: 224                 # Standard resolution

out:
  dir: outputs/colab_regnetx_3.2gf
  submission_path: data/submission_regnetx_3.2gf.csv
