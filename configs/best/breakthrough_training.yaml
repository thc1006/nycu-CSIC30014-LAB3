# çªç ´ 82 åˆ†çš„å„ªåŒ–è¨“ç·´é…ç½®
# GPU: RTX 4070 Ti SUPER (16GB)
# ç›®æ¨™: 85-87%+ Macro-F1

inherits: configs/base_colab.yaml

data:
  # ä½¿ç”¨ä¸‹è¼‰çš„å¯¦éš›å½±åƒè·¯å¾‘
  images_dir_train: train_images
  images_dir_val: val_images
  images_dir_test: test_images
  train_csv: data/train_data.csv
  val_csv: data/val_data.csv
  test_csv: data/test_data.csv
  file_col: new_filename
  label_cols: [normal, bacteria, virus, COVID-19]
  num_classes: 4

train:
  seed: 42

  # ğŸ”¥ æ¦¨ä¹¾ GPU - é•·æ™‚é–“è¨“ç·´
  epochs: 40
  batch_size: 20  # 16GB VRAM å¯ä»¥æ”¯æ´

  # å„ªåŒ–å™¨é…ç½®
  num_workers: 8  # å¤šç·šç¨‹åŠ è¼‰
  lr: 0.0001  # è¼ƒå°å­¸ç¿’ç‡é…åˆé•·è¨“ç·´
  weight_decay: 0.0001
  optimizer: adamw

  # å­¸ç¿’ç‡èª¿åº¦
  scheduler: cosine
  warmup_epochs: 5  # æ›´é•·çš„ warmup

  # é—œéµï¼šè™•ç†æ¥µåº¦ä¸å¹³è¡¡
  use_weighted_sampler: true

  # ğŸ¯ æ ¸å¿ƒæ”¹é€²ï¼šé«˜æ¬Šé‡ Focal Loss
  loss: improved_focal
  focal_alpha: [1.0, 1.5, 2.0, 15.0]  # COVID-19 æ¥µé«˜æ¬Šé‡
  focal_gamma: 3.0  # æ›´èšç„¦å›°é›£æ¨£æœ¬
  label_smoothing: 0.1

  # ğŸ”¥ æ¿€é€²çš„è³‡æ–™å¢å¼·
  augment: true
  advanced_aug: true
  mixup_prob: 0.5
  mixup_alpha: 1.0
  cutmix_prob: 0.5
  cutmix_alpha: 1.0

  # é«˜ç´šå¢å¼·åƒæ•¸
  aug_rotation: 15
  aug_translate: 0.1
  aug_scale_min: 0.9
  aug_scale_max: 1.1
  aug_shear: 10
  random_erasing_prob: 0.3

  # ğŸŒŸ Stochastic Weight Averaging
  use_swa: true
  swa_start_epoch: 30
  swa_lr: 0.00005

perf:
  # ğŸš€ æ··åˆç²¾åº¦è¨“ç·´ï¼ˆæ¦¨ä¹¾ GPUï¼‰
  amp_dtype: fp16  # RTX 4070 Ti æ”¯æ´
  channels_last: true  # è¨˜æ†¶é«”å„ªåŒ–
  cudnn_benchmark: true  # è‡ªå‹•å„ªåŒ–
  tf32: high  # é«˜ç²¾åº¦

model:
  # ğŸ¯ ä½¿ç”¨é«˜æ•ˆèƒ½æ¨¡å‹
  name: efficientnet_v2_s  # æˆ– convnext_tiny
  img_size: 384  # å¹³è¡¡æ•ˆèƒ½å’Œæº–ç¢ºåº¦
  pretrained: true

out:
  dir: outputs/breakthrough_run
  checkpoint_path: outputs/breakthrough_run/best.pt
  submission_path: data/submission_breakthrough.csv
